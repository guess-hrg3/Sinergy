from utils.dates import parse_date

def parse_funcionario_xml(xml_func):
    def get_text(tag):
        el = xml_func.find(tag)
        return el.text.strip() if el is not None and el.text else None

    return {
        "fil_cod": int(get_text('fil_cod')) if get_text('fil_cod') else None,
        "func_num": int(get_text('func_num')) if get_text('func_num') else None,
        "func_nom": get_text('func_nom'),
        "func_nom_end": get_text('func_nom_end'),
        "func_nom_bairro": get_text('func_nom_bairro'),
        "cid_cod": get_text('cid_cod'),
        "func_cod_cep": get_text('func_cod_cep'),
        "func_sts_sexo": get_text('func_sts_sexo'),
        "estcv_cod": get_text('estcv_cod'),
        "nac_cod": get_text('nac_cod'),
        "func_dat_nasc": parse_date(get_text('func_dat_nasc')),
        "func_dat_adm_banco": parse_date(get_text('func_dat_adm_banco')),
        "func_dat_adm_secao": parse_date(get_text('func_dat_adm_secao')),
        "func_num_tel_res": get_text('func_num_tel_res'),
        "ccu_nom": get_text('ccu_nom'),
        "ccu_cod": get_text('ccu_cod'),
        "func_dat_dem": parse_date(get_text('func_dat_dem')),
        "func_sts_dem": get_text('func_sts_dem'),
        "desc_motivo_rescisao": get_text('desc_motivo_rescisao'),
        "func_sts": get_text('func_sts'),
        "func_num_cpf": get_text('func_num_cpf'),
        "cod_tipo_cargo": get_text('cod_tipo_cargo'),
        "desc_tipo_cargo": get_text('desc_tipo_cargo'),
        "func_dat_carga": parse_date(get_text('func_dat_carga')),
        "func_sts_headcount": get_text('func_sts_headcount'),
        "func_id_number": get_text('func_id_number'),
        "func_num_cel": get_text('func_num_cel'),
        "func_num_rg": get_text('func_num_rg'),
        "func_emissor_rg": get_text('func_emissor_rg'),
        "func_uf_rg": get_text('func_uf_rg'),
        "func_pais_rg": get_text('func_pais_rg'),
        "func_dh_emissao_rg": parse_date(get_text('func_dh_emissao_rg')),
        "func_num_pis": get_text('func_num_pis'),
        "func_location": get_text('func_location'),
        "func_email": get_text('func_email'),
        "cnpj_unidade": get_text('cnpj_unidade'),
        "gestor_nome": get_text('gestor_nome'),
        "gestor_cpf": get_text('gestor_cpf'),
        "func_sn_gestor": get_text('func_sn_gestor'),
        "func_celular_ddd": get_text('func_celular_ddd'),
        "func_celular_numero": get_text('func_celular_numero'),
        "func_deficiente": get_text('func_deficiente'),
        "func_deficiente_fisico": get_text('func_deficiente_fisico'),
        "func_deficiente_visual": get_text('func_deficiente_visual'),
        "func_deficiente_auditivo": get_text('func_deficiente_auditivo'),
        "func_deficiente_mental": get_text('func_deficiente_mental'),
        "func_deficiente_intelectual": get_text('func_deficiente_intelectual'),
        "func_codigo_hierarquia": get_text('func_codigo_hierarquia'),
        "func_descricao_hierarquia": get_text('func_descricao_hierarquia'),
        "func_local_trab_codigo": get_text('func_local_trab_codigo'),
        "func_local_trabalho_descricao": get_text('func_local_trabalho_descricao'),
        "func_local_trabalho_municipio": get_text('func_local_trabalho_municipio'),
        "razao_social": get_text('razao_social'),
        "nome_mae": get_text('nome_mae'),
        "cid_nasc": get_text('cid_nasc'),
        "cid_nome": get_text('cid_nome'),
        "func_uf": get_text('func_uf'),
        "func_pais": get_text('func_pais'),
        "cod_vinculo": get_text('cod_vinculo'),
        "cod_estab": int(get_text('cod_estab')) if get_text('cod_estab') else None,
        "nom_vinculo": get_text('nom_vinculo'),
        "num_ctps": get_text('num_ctps'),
        "serie_ctps": get_text('serie_ctps'),
        "ctps_uf": get_text('ctps_uf'),
        "ctps_dt": parse_date(get_text('ctps_dt')),
        "desc_funcao_cargo": get_text('desc_funcao_cargo'),
        "cod_cbo": get_text('cod_cbo'),
        "desc_cbo": get_text('desc_cbo'),
        "cod_sindicato": get_text('cod_sindicato'),
        "nom_sindicato": get_text('nom_sindicato'),
        "end_sindicato": get_text('end_sindicato'),
        "cod_escala": get_text('cod_escala'),
        "desc_escala": get_text('desc_escala'),
        "desc_ponto": get_text('desc_ponto'),
        "func_nom_soc": get_text('func_nom_soc'),
        "func_dh_aviso_previo": parse_date(get_text('func_dh_aviso_previo')),
        "escolaridade": get_text('escolaridade'),
        "raca_cor": get_text('raca_cor'),
        "func_email_pessoal": get_text('func_email_pessoal'),
        "email_gestor": get_text('email_gestor'),
        "matricula_gestor": get_text('matricula_gestor'),
        "dc_ficha_fls": get_text('dc_ficha_fls'),
        "nu_cracha": get_text('nu_cracha'),
        "banco": get_text('banco'),
        "conta_bancaria": get_text('conta_bancaria'),
        "agencia_bancaria": get_text('agencia_bancaria'),
        "nm_usuario_aprovador": get_text('nm_usuario_aprovador'),
        "func_pais_nacionalidade": get_text('func_pais_nacionalidade'),
        "tempo_cargo_atual": int(get_text('tempo_cargo_atual')) if get_text('tempo_cargo_atual') else None,
        "nu_cns": get_text('nu_cns'),
        "dh_expedicao_cnh": parse_date(get_text('dh_expedicao_cnh')),
        "uf_cid_nascimento": get_text('uf_cid_nascimento'),
        "uf_local_trabalho": get_text('uf_local_trabalho'),
        "sg_genero": get_text('sg_genero'),
        "sg_orientacao": get_text('sg_orientacao'),
        "numero_fre": get_text('numero_fre'),
        "saldo_ferias": float(get_text('saldo_ferias').replace(',', '.')) if get_text('saldo_ferias') else None,
        "recebe_adiantamento": get_text('recebe_adiantamento'),
        "matricula_esocial": get_text('matricula_esocial'),
        "carga_horaria": float(get_text('carga_horaria')) if get_text('carga_horaria') else None,
        "sg_tipo_salario": get_text('sg_tipo_salario'),
        "gestor_original": get_text('gestor_original'),
        "nm_conta_func": get_text('nm_conta_func'),
        "dg_conta_func": get_text('dg_conta_func'),
        "nm_conta_ag": get_text('nm_conta_ag'),
        "dg_conta_ag": get_text('dg_conta_ag'),
        "tipo_estabilidade": get_text('tipo_estabilidade'),
        "inicio_estabilidade": parse_date(get_text('inicio_estabilidade')),
        "fim_estabilidade": parse_date(get_text('fim_estabilidade')),
        "tipo_logradouro": get_text('tipo_logradouro'),
        "identificador_jornada": get_text('identificador_jornada'),
        "contribuicao_sindical": get_text('contribuicao_sindical'),
        "contribuicao_assistencial": get_text('contribuicao_assistencial'),
        "apelido": get_text('apelido'),
        "cd_motivo_rescisao": get_text('cd_motivo_rescisao'),
        "comunidade_lgbt": get_text('comunidade_lgbt'),
        "modelo_contrato": get_text('modelo_contrato'),
        "rua": get_text('rua'),
        "numero_endereco": get_text('numero_endereco'),
        "complemento": get_text('complemento'),
        "titulo_reduzido": get_text('titulo_reduzido'),
    }
